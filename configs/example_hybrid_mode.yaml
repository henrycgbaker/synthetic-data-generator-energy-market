# Example: Hybrid Mode with Stochastic Breakpoints
# This config showcases: Mix of global and local regime definitions
# Inherits from: _base_template.yaml
#
# KEY FEATURE BEING TESTED: Hybrid mode with stochastic breakpoint generation

# ===== OVERRIDE: Simulation Parameters =====
start_ts: "2025-01-01 00:00"
days: 90
freq: "h"

# ===== OVERRIDE: Supply Regime Planner =====
supply_regime_planner:
  mode: "hybrid"
  global_settings:
    n_regimes: 3
    sync_regimes: true
    
    # Stochastic breakpoints instead of explicit
    stochastic_breakpoints:
      enabled: true
      min_segment_days: 20
      max_segment_days: 40
      transition_hours:
        type: "range"
        min: 24
        max: 168

    # Distribution templates for auto-generation
    distribution_templates:
      fuel.coal:
        kind: "normal"
        mu: 30
        sigma: 5
        bounds: {low: 10, high: 100}

      fuel.oil:
        kind: "normal"
        mu: 50
        sigma: 8
        bounds: {low: 20, high: 150}

      avail.nuclear:
        kind: "beta"
        alpha: 30
        beta: 2
        low: 0.95
        high: 1.0

      avail.coal:
        kind: "beta"
        alpha: 15
        beta: 3
        low: 0.85
        high: 1.0

      avail.wind:
        kind: "beta"
        alpha: 20
        beta: 6
        low: 0.7
        high: 1.0

# ===== OVERRIDE: Variables =====
variables:
  # Example 1: Full local specification with local breakpoints (overrides global)
  fuel.gas:
    regimes:
      - name: "low_price"
        dist: {kind: "normal", mu: 25.0, sigma: 3.0, bounds: {low: 15.0, high: 60.0}}
        breakpoints:
          - date: "2025-01-01"
            transition_hours: 48
      - name: "high_price"
        dist: {kind: "normal", mu: 70.0, sigma: 10.0, bounds: {low: 40.0, high: 120.0}}
        breakpoints:
          - date: "2025-02-15"
            transition_hours: 96
      - name: "normal_price"
        dist: {kind: "normal", mu: 35.0, sigma: 5.0, bounds: {low: 20.0, high: 80.0}}

  # Example 2: Distributions only (uses global breakpoints)
  cap.gas:
    regimes:
      - name: "capacity_1"
        dist: {kind: "const", v: 12000.0}
      - name: "capacity_2"
        dist: {kind: "const", v: 13000.0}
      - name: "capacity_3"
        dist: {kind: "const", v: 12500.0}

  cap.nuclear:
    regimes:
      - name: "constant"
        dist: {kind: "const", v: 5000.0}

  # Example 3: Empty (uses global template)
  fuel.coal:
    regimes: []

  fuel.oil:
    regimes: []

  avail.nuclear:
    regimes: []

  avail.coal:
    regimes: []

  # Example 4: Single regime (constant throughout)
  cap.wind:
    regimes:
      - name: "constant_wind"
        dist: {kind: "const", v: 6000.0}

  cap.solar:
    regimes:
      - name: "constant_solar"
        dist: {kind: "const", v: 4000.0}

  avail.gas:
    regimes:
      - name: "baseline"
        dist: {kind: "beta", alpha: 22, beta: 2, low: 0.88, high: 0.98}

  # Thermal efficiencies and bids inherit from base template

# ===== OVERRIDE: Planned Outages =====
planned_outages:
  enabled: false

# ===== OVERRIDE: Output Configuration =====
io:
  out_dir: "outputs"
  dataset_name: "hybrid_stochastic_example"
  add_timestamp: true
  version: "v1"
  save_pickle: true
  save_csv: true
  save_meta: false
